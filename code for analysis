import os
import pandas as pd
from analysis.technical_analysis import compute_technical_indicators, generate_signals
from analysis.sentiment_analysis import analyze_sentiment

DATA_FOLDER = "data_collection/historical_data"

def analyze_all_symbols():
    results = []

    for filename in os.listdir(DATA_FOLDER):
        if filename.endswith(".csv"):
            symbol = filename.replace(".csv", "").upper()
            filepath = os.path.join(DATA_FOLDER, filename)
            
            try:
                df = pd.read_csv(filepath)
                if df.empty or 'Close' not in df.columns:
                    print(f"âš ï¸ Skipping {symbol} - invalid or empty file")
                    continue

                df = compute_technical_indicators(df)
                signals = generate_signals(df)

                dummy_news = [
                    f"{symbol} stock shows strength",
                    f"Analyst upgrades {symbol} to buy"
                ]
                sentiment = analyze_sentiment(dummy_news)

                results.append({
                    "Symbol": symbol,
                    "Signals": signals,
                    "Sentiment": sentiment
                })

                print(f"âœ… Analyzed: {symbol}")

            except Exception as e:
                print(f"âŒ Error processing {symbol}: {str(e)}")

    return results


if __name__ == "__main__":
    summary = analyze_all_symbols()
    print("\nğŸ“Š FINAL ANALYSIS SUMMARY ğŸ“Š")
    for res in summary:
        print(f"\nğŸ§  {res['Symbol']}")
        print(f"ğŸ“ˆ Signals: {res['Signals']}")
        print(f"ğŸ“° Sentiment: {res['Sentiment']}")



ğŸ“ Repo Folder Structure (for reference):
Copy
Edit
your-repo/
â”œâ”€â”€ analysis/
â”‚   â”œâ”€â”€ technical_analysis.py
â”‚   â”œâ”€â”€ sentiment_analysis.py
â”‚   â””â”€â”€ multi_symbol_analysis.py
â”œâ”€â”€ data_collection/
â”‚   â””â”€â”€ historical_data/
â”‚       â”œâ”€â”€ AAPL.csv
â”‚       â”œâ”€â”€ TSLA.csv
â”‚       â””â”€â”€ ...
ğŸ Install the required Python packages (put in README too!)
bash
Copy
Edit
pip install pandas talib vaderSentiment
ğŸ§  Want to add?
âœ… Save output to CSV or JSON?

âœ… Generate plots and graphs?

âœ… Real alerts sent to n8n/email/telegram?

âœ… Run this from your GitHub Actions every day?
